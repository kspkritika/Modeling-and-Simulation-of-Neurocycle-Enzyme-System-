function dydx = FjPsi(Psi,y,hf) % right hand side of DE function
thet1=32000; thet2=4; thet3=0.125; thet4=0.125; thet5=84500; thet6=65;
thet7=76.72; thet8=0.00769; al=0.5; ga=0.01; del=0.1; VR=1.2;
a11=1; a12=0; a21=1; a22=-1; a31=1; a32=0; a41=0; a42=1; b1=1; b2=VR;
alHp=2.25; alHm=0.5; alS1=1; alS2=1; alS3=1; B1=5.033*10^-5; B2=5.033*10^-5;
Kh1=1.0066*10^-6; Ks1=5.033*10^-7; S2ref=0.0001; S3ref=0.000001;
s1f=2.4; s2f=1.15; s3f=3.9;hf = 0.004544; % list with parameter values
r1 = (y(3,:).*y(4,:))./((y(3,:) + thet1./y(1,:) + thet2 + thet3*y(1,:) + ...
thet4*y(3,:).^2) .* (y(4,:) + thet5./y(1,:) + thet6 + thet7*y(1,:) + ...
thet8*y(4,:).^2)); % rate equations
r2 = y(6,:)./(y(6,:) + 1./y(5,:) + 1 + del*y(5,:) + al*y(6,:).^2);
dydx = [a11*((hf - y(1,:)) - ga*(1/hf - 1./y(1,:))) - ... % 8 DEs
b1*a21*(alHp*(y(1,:)-y(5,:)) - ga*alHm*(1./y(1,:)-1./y(5,:))) + ...
b1*a41*B2*r2/Kh1;
a11*(s1f-y(2,:)) - b1*a21*alS1*(y(2,:)-y(6,:)) + b1*(a31*B1*r1/Ks1 ...
- a41*B2*r2/Ks1);
a11*(s2f-y(3,:)) - b1*a21*alS2*(y(3,:)-y(7,:)) + b1*(-a31*B1*r1/S2ref ...
+ a41*B2*r2/S2ref);
a11*(s3f-y(4,:)) - b1*a21*alS3*(y(4,:)-y(8,:)) + b1*(-a31*B1*r1/S3ref ...
+ a41*B2*r2/S3ref);
a12*((hf - y(1,:)) - ga*(1/hf - 1./y(1,:))) - ...
b2*a22*(alHp*(y(1,:)-y(5,:)) - ga*alHm*(1./y(1,:)-1./y(5,:))) + ...
b2*a42*B2*r2/Kh1;
a12*(s1f-y(2,:)) - b2*a22*alS1*(y(2,:)-y(6,:)) + b2*(a32*B1*r1/Ks1 ...
- a42*B2*r2/Ks1);
a12*(s2f-y(3,:)) - b2*a22*alS2*(y(3,:)-y(7,:)) + b2*(-a32*B1*r1/S2ref ...
+ a42*B2*r2/S2ref);
a12*(s3f-y(4,:)) - b2*a22*alS3*(y(4,:)-y(8,:)) + b2*(-a32*B1*r1/S3ref ...
+ a42*B2*r2/S3ref)];